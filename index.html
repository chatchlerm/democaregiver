<!doctype html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Zyta Dashboard (1 Page ‚Ä¢ White / Light Blue)</title>

  <style>
    :root{
      --bg:#f2f8ff;
      --card:#ffffff;
      --muted:#5b6b82;
      --text:#0b1220;
      --border:#d7e6f8;
      --soft:#eef6ff;
      --accent:#2563eb;
      --accent-2:#0ea5e9;
      --accent-soft:#e8f4ff;
      --shadow: 0 14px 32px rgba(11,18,32,.10);
      --radius: 18px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial;
      background:
        radial-gradient(900px 420px at 18% 0%, rgba(14,165,233,.18), transparent 60%),
        radial-gradient(900px 420px at 90% 18%, rgba(37,99,235,.14), transparent 55%),
        linear-gradient(180deg, #ffffff 0%, var(--bg) 45%, var(--bg) 100%);
      color:var(--text);
    }
    .wrap{
      max-width:420px;
      margin:0 auto;
      padding:18px 16px 110px;
    }

    /* Topbar */
    .topbar{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      margin-bottom:14px;
    }
    .iconbtn{
      width:44px;height:44px;
      border-radius:14px;
      background:linear-gradient(180deg,#fff, var(--soft));
      border:1px solid var(--border);
      display:grid;
      place-items:center;
      box-shadow: 0 10px 24px rgba(11,18,32,.08);
      user-select:none;
      color:#274061;
      cursor:pointer;
    }
    .iconbtn:active{ transform: translateY(1px); }
    .title{
      text-align:center;
      line-height:1.15;
    }
    .title .h{
      font-weight:900;
      font-size:16px;
      letter-spacing:-.2px;
    }
    .title .s{
      margin-top:3px;
      font-size:11px;
      color:var(--muted);
    }

    /* Base */
    .card{
      background:var(--card);
      border:1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: 0 10px 28px rgba(11,18,32,.08);
    }
    .hide{display:none}
    .muted{color:var(--muted)}
    .section{ margin-top:12px; }

    /* Home metrics */
    .grid2{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:12px;
    }
    .metric{
      padding:14px;
      display:flex;
      gap:12px;
      align-items:flex-start;
    }
    .badge{
      width:40px;height:40px;
      border-radius:14px;
      display:grid;
      place-items:center;
      background:linear-gradient(180deg, #ffffff, var(--accent-soft));
      border:1px solid rgba(14,165,233,.25);
      color:var(--accent-2);
      flex:0 0 auto;
    }
    .metric .lbl{ font-size:12px; color:var(--muted); }
    .metric .val{ margin-top:4px; display:flex; gap:8px; align-items:baseline; flex-wrap:wrap; }
    .metric .val b{ font-size:20px; letter-spacing:-.4px; }
    .metric .val span{ font-size:11px; color:var(--muted); }

    /* Charts box */
    .chartBox{
      margin-top:12px;
      padding:12px;
      border-radius:16px;
      background:linear-gradient(180deg,#fff,var(--soft));
      border:1px solid var(--border);
    }
    .chartTitle{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      margin-bottom:8px;
    }
    .chartTitle b{ font-size:13px; }
    .pill{
      padding:6px 10px;
      border-radius:999px;
      background: linear-gradient(180deg, #ffffff, var(--accent-soft));
      border:1px solid rgba(14,165,233,.28);
      color: var(--accent-2);
      font-size:11px;
      font-weight:900;
      white-space:nowrap;
    }
    canvas{ width:100% !important; height:190px !important; }

    /* Alerts cards */
    .alertList{ display:grid; gap:10px; }
    .alertItem{
      padding:12px;
      display:flex;
      gap:10px;
      align-items:flex-start;
      border:1px solid var(--border);
      border-radius:16px;
      background:linear-gradient(180deg,#fff,var(--soft));
    }
    .alertIcon{
      width:34px;height:34px;
      border-radius:12px;
      border:1px solid rgba(14,165,233,.25);
      background:#fff;
      display:grid;
      place-items:center;
      box-shadow: 0 10px 20px rgba(11,18,32,.06);
      flex:0 0 auto;
    }
    .alertMain{ font-weight:900; font-size:13px; }
    .alertSub{ margin-top:3px; font-size:12px; color:var(--muted); line-height:1.35; }
    .alertMeta{ margin-top:6px; font-size:11px; color:#6b86a8; }

    /* Segmented (member select) */
    .seg{
      margin-top:12px;
      border:1px solid var(--border);
      background:linear-gradient(180deg,#fff, var(--soft));
      border-radius:16px;
      padding:6px;
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap:6px;
    }
    .seg button{
      border:1px solid transparent;
      background:transparent;
      border-radius:12px;
      padding:10px 8px;
      font-size:12px;
      color:var(--muted);
      cursor:pointer;
      font-weight:900;
      user-select:none;
    }
    .seg button.active{
      background: var(--accent-soft);
      border-color: rgba(14,165,233,.28);
      color: var(--accent-2);
      box-shadow: 0 10px 24px rgba(14,165,233,.12);
    }

    /* Trend summary cards */
    .trendGrid{ display:grid; gap:10px; margin-top:12px; }
    .trendCard{
      padding:12px;
      border:1px solid var(--border);
      border-radius:16px;
      background:linear-gradient(180deg,#fff, var(--soft));
    }
    .trendHead{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:10px;
    }
    .trendHead b{ font-size:13px; }
    .trendSmall{ margin-top:5px; font-size:12px; color:var(--muted); line-height:1.35; }
    .tags{ margin-top:8px; display:flex; flex-wrap:wrap; gap:8px; }
    .tag{
      display:inline-flex;
      align-items:center;
      gap:6px;
      padding:6px 10px;
      border-radius:999px;
      background: var(--accent-soft);
      border:1px solid rgba(14,165,233,.28);
      color: var(--accent-2);
      font-size:11px;
      font-weight:900;
      white-space:nowrap;
    }
    .tag b{ color: var(--accent); }

    .encourage{
      margin-top:12px;
      padding:12px;
      border-radius:16px;
      border:1px solid rgba(14,165,233,.28);
      background: linear-gradient(180deg, #ffffff, rgba(232,244,255,.95));
    }
    .encourage b{ font-size:13px; }
    .encourage p{ margin:8px 0 0; font-size:12px; color:#2b4769; line-height:1.45; }

    /* Profile picker */
    .profileGrid{ display:grid; grid-template-columns: 1fr 1fr; gap:12px; margin-top:12px; }
    .personBtn{
      border:1px solid var(--border);
      border-radius:16px;
      background:linear-gradient(180deg,#fff,var(--soft));
      padding:12px;
      cursor:pointer;
      text-align:left;
      box-shadow: 0 10px 20px rgba(11,18,32,.06);
    }
    .personBtn.active{
      outline: 2px solid rgba(14,165,233,.45);
      border-color: rgba(14,165,233,.45);
      background: linear-gradient(180deg, #fff, rgba(232,244,255,.95));
    }
    .personTop{ display:flex; align-items:center; gap:10px; }
    .personAvatar{
      width:40px;height:40px;border-radius:14px;
      border:1px solid rgba(14,165,233,.25);
      background:#fff;
      display:grid;
      place-items:center;
      font-size:18px;
    }
    .personName{ font-weight:900; font-size:13px; }
    .personRole{ margin-top:2px; font-size:11px; color:var(--muted); }
    .personHint{ margin-top:8px; font-size:12px; color:#2b4769; }

    /* Settings */
    .settingsSection{ padding: 0 14px 12px; }
    .settingsTitle{
      font-size:11px;
      font-weight:900;
      letter-spacing:.2px;
      color:#2b4769;
      margin: 2px 2px 8px;
      text-transform: uppercase;
    }
    .settingsList{
      border:1px solid var(--border);
      border-radius:16px;
      overflow:hidden;
      background:linear-gradient(180deg,#fff,var(--soft));
      box-shadow: 0 10px 24px rgba(11,18,32,.06);
    }
    .settingsItem{
      width:100%;
      display:flex;
      gap:10px;
      align-items:center;
      padding:12px 12px;
      border:0;
      background:transparent;
      text-align:left;
      cursor:default; /* dummy only */
    }
    .settingsItem + .settingsItem{ border-top:1px solid rgba(215,230,248,.9); }
    .settingsIcon{
      width:34px; height:34px;
      border-radius:12px;
      display:grid;
      place-items:center;
      background:#fff;
      border:1px solid rgba(215,230,248,.9);
      box-shadow: 0 10px 22px rgba(11,18,32,.05);
      font-size:16px;
      flex:0 0 auto;
    }
    .settingsText{ flex:1; min-width:0; }
    .settingsMain{ display:block; font-weight:900; font-size:13px; color:#0b1220; }
    .settingsSub{ display:block; margin-top:2px; font-size:11px; color:var(--muted); }
    .settingsArrow{ color:#6b86a8; font-size:18px; font-weight:900; }

    /* Auth (Sign in) */
    .authHero{ margin-top:8px; }
    .authHero b{ font-size:14px; }
    .authHero p{ margin:6px 0 0; font-size:12px; color:var(--muted); line-height:1.45; }

    .authBox{ margin-top:12px; border:1px solid var(--border); border-radius:16px; overflow:hidden; background:linear-gradient(180deg,#fff,var(--soft)); box-shadow: 0 10px 24px rgba(11,18,32,.06); }
    .authTabs{ display:grid; grid-template-columns:1fr 1fr; gap:6px; padding:6px; border-bottom:1px solid rgba(215,230,248,.9); }
    .authTabs button{ border:1px solid transparent; background:transparent; border-radius:12px; padding:10px 8px; font-size:12px; color:var(--muted); cursor:pointer; font-weight:900; }
    .authTabs button.active{ background: var(--accent-soft); border-color: rgba(14,165,233,.28); color: var(--accent-2); box-shadow: 0 10px 24px rgba(14,165,233,.12); }

    .authPane{ padding:12px; }
    .field{ display:grid; gap:6px; margin-top:10px; }
    .field label{ font-size:11px; font-weight:900; color:#2b4769; }
    .input{
      width:100%;
      border:1px solid var(--border);
      border-radius:14px;
      padding:12px 12px;
      background:#fff;
      font-size:13px;
      outline:none;
    }
    .input:focus{ border-color: rgba(14,165,233,.45); box-shadow: 0 0 0 4px rgba(14,165,233,.12); }

    .authPrimary{
      margin-top:12px;
      width:100%;
      border:1px solid rgba(14,165,233,.35);
      border-radius:16px;
      padding:12px 12px;
      font-weight:900;
      cursor:pointer;
      background: linear-gradient(180deg, #ffffff, var(--accent-soft));
      color: var(--accent);
      box-shadow: 0 10px 24px rgba(14,165,233,.12);
    }
    .authNote{ margin-top:10px; font-size:11px; color:var(--muted); line-height:1.45; }

    .divider{ display:flex; align-items:center; gap:10px; margin:12px 0; color:#6b86a8; font-size:11px; font-weight:900; }
    .divider:before,.divider:after{ content:""; height:1px; flex:1; background: rgba(215,230,248,.9); }

    .oauthList{ display:grid; gap:10px; }
    .oauthBtn{
      width:100%;
      display:flex;
      align-items:center;
      gap:10px;
      padding:12px;
      border-radius:16px;
      border:1px solid var(--border);
      background:linear-gradient(180deg,#fff,var(--soft));
      cursor:pointer;
      text-align:left;
    }
    .oauthIco{ width:34px;height:34px; border-radius:12px; display:grid; place-items:center; border:1px solid rgba(215,230,248,.9); background:#fff; box-shadow: 0 10px 22px rgba(11,18,32,.05); }
    .oauthMain{ font-weight:900; font-size:13px; }
    .oauthSub{ margin-top:2px; font-size:11px; color:var(--muted); }

    /* Account (After login) */
    .accountHeader{ display:flex; align-items:flex-start; justify-content:space-between; gap:10px; }
    .accountHeader b{ font-size:14px; }
    .accountHeader .muted{ font-size:12px; margin-top:4px; }

    .walletCard{
      margin-top:12px;
      padding:12px;
      border:1px solid rgba(14,165,233,.28);
      border-radius:16px;
      background: linear-gradient(180deg, #ffffff, rgba(232,244,255,.95));
    }
    .walletTop{ display:flex; align-items:center; justify-content:space-between; gap:10px; }
    .walletTop .amt{ font-weight:900; font-size:20px; letter-spacing:-.3px; }
    .walletTop .unit{ font-size:11px; color:var(--muted); font-weight:900; }
    .walletMeta{ margin-top:6px; font-size:12px; color:#2b4769; }

    .menuGrid{ display:grid; grid-template-columns: 1fr 1fr; gap:12px; margin-top:12px; }

    /* Packages */
    .packageWrap{ margin-top:12px; }
    .packageGrid{ display:grid; gap:10px; margin-top:12px; }
    .packageBtn{
      width:100%;
      display:flex;
      align-items:flex-start;
      gap:10px;
      padding:12px;
      border-radius:16px;
      border:1px solid var(--border);
      background:linear-gradient(180deg,#fff,var(--soft));
      cursor:pointer;
      text-align:left;
      box-shadow: 0 10px 20px rgba(11,18,32,.06);
    }
    .packageBtn:active{ transform: translateY(1px); }
    .packageBtn.active{
      outline: 2px solid rgba(34,197,94,.35);
      border-color: rgba(34,197,94,.45);
      background: linear-gradient(180deg, #fff, rgba(232,244,255,.95));
    }
    .packageName{ font-weight:900; font-size:13px; }
    .packageSub{ margin-top:3px; font-size:11px; color:var(--muted); line-height:1.35; }
    .packageMeta{ margin-top:8px; display:flex; gap:8px; flex-wrap:wrap; }
    .packageChip{
      display:inline-flex;
      align-items:center;
      gap:6px;
      padding:6px 10px;
      border-radius:999px;
      background: var(--accent-soft);
      border:1px solid rgba(14,165,233,.28);
      color: var(--accent-2);
      font-size:11px;
      font-weight:900;
      white-space:nowrap;
    }
    .packageChip b{ color: var(--accent); }

    .menuBtn{
      border:1px solid var(--border);
      border-radius:16px;
      background:linear-gradient(180deg,#fff,var(--soft));
      padding:12px;
      cursor:pointer;
      text-align:left;
      box-shadow: 0 10px 20px rgba(11,18,32,.06);
      display:flex;
      gap:10px;
      align-items:flex-start;
    }
    .menuBtn:active{ transform: translateY(1px); }
    .menuIco{
      width:40px;height:40px;
      border-radius:14px;
      border:1px solid rgba(14,165,233,.25);
      background:#fff;
      display:grid;
      place-items:center;
      font-size:18px;
      flex:0 0 auto;
      box-shadow: 0 10px 22px rgba(11,18,32,.05);
    }
    .menuMain{ font-weight:900; font-size:13px; }
    .menuSub{ margin-top:3px; font-size:11px; color:var(--muted); line-height:1.35; }

    .primaryBtn{
      width:100%;
      border:1px solid rgba(14,165,233,.35);
      border-radius:16px;
      padding:12px 12px;
      font-weight:900;
      cursor:pointer;
      background: linear-gradient(180deg, #ffffff, var(--accent-soft));
      color: var(--accent);
      box-shadow: 0 10px 24px rgba(14,165,233,.12);
    }

    /* Top-up */
    .amountGrid{ display:grid; grid-template-columns: repeat(3, 1fr); gap:10px; margin-top:12px; }
    .amountBtn{
      border:1px solid var(--border);
      border-radius:16px;
      background:linear-gradient(180deg,#fff,var(--soft));
      padding:12px 10px;
      cursor:pointer;
      text-align:center;
      font-weight:900;
      color:#274061;
    }
    .amountBtn.active{
      outline: 2px solid rgba(14,165,233,.45);
      border-color: rgba(14,165,233,.45);
      background: linear-gradient(180deg, #fff, rgba(232,244,255,.95));
      color: var(--accent);
    }
    .methodList{ display:grid; gap:10px; margin-top:12px; }
    .methodBtn{
      width:100%;
      display:flex;
      align-items:center;
      gap:10px;
      padding:12px;
      border-radius:16px;
      border:1px solid var(--border);
      background:linear-gradient(180deg,#fff,var(--soft));
      cursor:pointer;
      text-align:left;
    }
    .methodBtn.active{ outline: 2px solid rgba(14,165,233,.45); border-color: rgba(14,165,233,.45); }

    .txnList{ display:grid; gap:10px; margin-top:12px; }
    .txnItem{ padding:12px; border:1px solid var(--border); border-radius:16px; background:linear-gradient(180deg,#fff,var(--soft)); }
    .txnTop{ display:flex; align-items:flex-start; justify-content:space-between; gap:10px; }
    .txnTop b{ font-size:12px; }
    .txnTop span{ font-size:11px; color:var(--muted); font-weight:900; }
    .txnSub{ margin-top:6px; font-size:12px; color:#2b4769; }

    /* Logged indicator on top right */
    #signInBtn.logged{ position:relative; }
    /* default: green dot */
    #signInBtn.logged:after{
      content:"";
      position:absolute;
      right:8px; top:8px;
      width:10px; height:10px;
      border-radius:999px;
      background: #22c55e;
      border:2px solid #fff;
      box-shadow: 0 10px 20px rgba(11,18,32,.10);
    }
    /* if user purchased a package: show label badge (green) */
    #signInBtn.logged.hasplan:after{
      content: attr(data-plan);
      width:auto; height:auto;
      padding:2px 7px;
      right:6px; top:6px;
      border-radius:999px;
      background:#22c55e;
      color:#ffffff;
      font-size:10px;
      font-weight:900;
      letter-spacing:.2px;
      border:2px solid #fff;
      box-shadow: 0 10px 20px rgba(11,18,32,.10);
      line-height:1.2;
    }

    /* Modal (pretty alert/confirm) */
    .modal{ position:fixed; inset:0; z-index:999; display:grid; place-items:center; padding:18px; }
    .modal.hide{ display:none; }
    .modalOverlay{ position:absolute; inset:0; background: rgba(11,18,32,.35); backdrop-filter: blur(8px); }
    .modalCard{
      position:relative;
      width:min(420px, 100%);
      border-radius: 18px;
      border:1px solid rgba(215,230,248,.95);
      background: linear-gradient(180deg,#ffffff, rgba(242,248,255,.96));
      box-shadow: 0 18px 40px rgba(11,18,32,.18);
      overflow:hidden;
      transform: translateY(8px);
      animation: modalIn .18s ease-out forwards;
    }
    @keyframes modalIn{ to{ transform: translateY(0); } }

    .modalHead{ padding:14px 14px 10px; display:flex; align-items:flex-start; justify-content:space-between; gap:10px; }
    .modalTitle{ display:flex; align-items:center; gap:10px; }
    .modalIcon{
      width:40px; height:40px; border-radius:14px;
      display:grid; place-items:center;
      border:1px solid rgba(14,165,233,.25);
      background:#fff;
      box-shadow: 0 10px 22px rgba(11,18,32,.05);
      font-size:18px;
      flex:0 0 auto;
    }
    .modalText b{ display:block; font-size:14px; letter-spacing:-.2px; }
    .modalText span{ display:block; margin-top:3px; font-size:12px; color:var(--muted); line-height:1.45; white-space:pre-line; }

    .modalClose{
      width:40px;height:40px;
      border-radius:14px;
      border:1px solid var(--border);
      background:linear-gradient(180deg,#fff,var(--soft));
      cursor:pointer;
      display:grid;
      place-items:center;
      color:#274061;
      box-shadow: 0 10px 24px rgba(11,18,32,.08);
    }
    .modalClose:active{ transform: translateY(1px); }

    .modalBody{ padding:0 14px 14px; }
    .modalActions{ display:flex; gap:10px; }
    .modalBtn{
      flex:1;
      border:1px solid rgba(14,165,233,.35);
      border-radius:16px;
      padding:12px 12px;
      font-weight:900;
      cursor:pointer;
      background: linear-gradient(180deg, #ffffff, var(--accent-soft));
      color: var(--accent);
      box-shadow: 0 10px 24px rgba(14,165,233,.12);
    }
    .modalBtn.secondary{
      border-color: rgba(215,230,248,.95);
      background: linear-gradient(180deg,#fff,var(--soft));
      color:#274061;
      box-shadow: 0 10px 24px rgba(11,18,32,.06);
    }

    .modalCard[data-type="success"] .modalIcon{ border-color: rgba(34,197,94,.35); }
    .modalCard[data-type="success"] .modalBtn{ border-color: rgba(34,197,94,.35); color:#166534; background: linear-gradient(180deg,#ffffff, rgba(220,252,231,.9)); }

    .modalCard[data-type="error"] .modalIcon{ border-color: rgba(239,68,68,.35); }
    .modalCard[data-type="error"] .modalBtn{ border-color: rgba(239,68,68,.35); color:#991b1b; background: linear-gradient(180deg,#ffffff, rgba(254,226,226,.95)); }

    .modalCard[data-type="warning"] .modalIcon{ border-color: rgba(245,158,11,.35); }
    .modalCard[data-type="warning"] .modalBtn{ border-color: rgba(245,158,11,.35); color:#92400e; background: linear-gradient(180deg,#ffffff, rgba(254,243,199,.95)); }

    /* Bottom nav */
    .navwrap{
      position:fixed;
      left:0; right:0; bottom:0;
      padding:0 16px 14px;
      z-index:50;
    }
    .nav{
      max-width:420px;
      margin:0 auto;
      background: rgba(255,255,255,.88);
      border:1px solid var(--border);
      border-radius: 18px;
      box-shadow: var(--shadow);
      backdrop-filter: blur(10px);
      padding:8px;
      display:grid;
      grid-template-columns: repeat(6, 1fr);
      gap:6px;
    }
    .nav button{
      border:1px solid transparent;
      background:transparent;
      border-radius:14px;
      padding:10px 6px;
      display:flex;
      flex-direction:column;
      gap:6px;
      align-items:center;
      justify-content:center;
      cursor:pointer;
      color:var(--muted);
      font-size:10px;
      user-select:none;
    }
    .nav button.active{
      background: var(--accent-soft);
      border-color: rgba(14,165,233,.28);
      color: var(--accent-2);
      font-weight:900;
    }
    .ico{width:18px;height:18px;display:block}
  </style>
</head>

<body>
  <div class="wrap">
    <!-- Topbar -->
    <div class="topbar">
      <button class="iconbtn" id="topBackBtn" type="button" aria-label="Back">
        <svg class="ico" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M15 18l-6-6 6-6" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </button>

      <div class="title">
        <div class="h" id="headerTitle">Zyta Dashboard</div>
        <div class="s" id="headerSub">‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ ‚Ä¢ 9 Jan</div>
      </div>

      <button class="iconbtn" id="signInBtn" type="button" aria-label="Sign in">
        <svg class="ico" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M20 21a8 8 0 10-16 0" stroke-linecap="round"/>
          <path d="M12 11a4 4 0 100-8 4 4 0 000 8z" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </button>
    </div>

    <!-- HOME -->
    <div id="screen-home">
      <div class="grid2">
        <div class="card metric">
          <div class="badge" aria-hidden="true">‚ù§Ô∏è</div>
          <div>
            <div class="lbl">Blood Pressure</div>
            <div class="val"><b>120/80</b> <span>mmHg ‚Ä¢ 72 bpm</span></div>
          </div>
        </div>

        <div class="card metric">
          <div class="badge" aria-hidden="true">üíß</div>
          <div>
            <div class="lbl">Blood Glucose</div>
            <div class="val"><b>105</b> <span>mg/dL</span></div>
          </div>
        </div>

        <div class="card metric">
          <div class="badge" aria-hidden="true">üå°Ô∏è</div>
          <div>
            <div class="lbl">Temperature</div>
            <div class="val"><b>36.5¬∞C</b> <span>today</span></div>
          </div>
        </div>

        <div class="card metric">
          <div class="badge" aria-hidden="true">üìà</div>
          <div>
            <div class="lbl">SpO‚ÇÇ</div>
            <div class="val"><b>98%</b> <span>normal</span></div>
          </div>
        </div>
      </div>

      <!-- Graph on Home -->
      <div class="card section" style="padding:14px;">
        <div class="chartTitle">
          <b>Today Trend</b>
          <span class="pill" id="activeUserPill">‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô: ‡∏û‡πà‡∏≠</span>
        </div>
        <div class="muted" style="font-size:12px; line-height:1.4;">‡∏Å‡∏£‡∏≤‡∏ü‡πÅ‡∏™‡∏î‡∏á‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</div>
        <div class="chartBox">
          <canvas id="homeTrendChart"></canvas>
        </div>
      </div>
    </div>

    <!-- ALERTS -->
    <div id="screen-alerts" class="hide">
      <div class="card" style="padding:14px;">
        <b>Alerts</b>
        <div class="muted" style="margin-top:6px;font-size:12px;">‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</div>

        <div class="section alertList">
          <div class="alertItem">
            <div class="alertIcon">üîî</div>
            <div>
              <div class="alertMain">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡∏™‡∏π‡∏á‡∏Å‡∏ß‡πà‡∏≤‡∏õ‡∏Å‡∏ï‡∏¥‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢</div>
              <div class="alertSub">‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÉ‡∏´‡πâ‡∏û‡∏±‡∏Å 5‚Äì10 ‡∏ô‡∏≤‡∏ó‡∏µ ‡πÅ‡∏•‡πâ‡∏ß‡∏ß‡∏±‡∏î‡∏ã‡πâ‡∏≥‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á</div>
              <div class="alertMeta">‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ 08:12 ‚Ä¢ ‡∏û‡πà‡∏≠</div>
            </div>
          </div>

          <div class="alertItem">
            <div class="alertIcon">üåô</div>
            <div>
              <div class="alertMain">‡∏ñ‡∏∂‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ß‡∏±‡∏î‡∏Ñ‡πà‡∏≤‡∏Å‡πà‡∏≠‡∏ô‡∏ô‡∏≠‡∏ô</div>
              <div class="alertSub">‡∏ß‡∏±‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô/SpO‚ÇÇ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ß‡∏±‡∏ô</div>
              <div class="alertMeta">‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ß‡∏≤‡∏ô 21:10 ‚Ä¢ ‡πÅ‡∏°‡πà</div>
            </div>
          </div>

          <div class="alertItem">
            <div class="alertIcon">üíß</div>
            <div>
              <div class="alertMain">‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏•‡∏´‡∏•‡∏±‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏™‡∏π‡∏á‡∏Ç‡∏∂‡πâ‡∏ô</div>
              <div class="alertSub">‡∏•‡∏≠‡∏á‡∏•‡∏î‡∏´‡∏ß‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏î‡∏¥‡∏ô‡πÄ‡∏ö‡∏≤ ‡πÜ ‡∏´‡∏•‡∏±‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£ 10‚Äì15 ‡∏ô‡∏≤‡∏ó‡∏µ</div>
              <div class="alertMeta">‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ß‡∏≤‡∏ô 13:45 ‚Ä¢ ‡∏¢‡∏≤‡∏¢</div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- TRENDS -->
    <div id="screen-trends" class="hide">
      <div class="card" style="padding:14px;">
        <div style="display:flex; align-items:flex-start; justify-content:space-between; gap:10px;">
          <div>
            <b>Trends</b>
            <div class="muted" style="margin-top:6px;font-size:12px;">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á 30 ‡∏ß‡∏±‡∏ô</div>
          </div>
          <span class="pill">Last 30 days</span>
        </div>

        <div class="seg" id="trendMemberSeg">
          <button class="active" data-member="dad" type="button">‡∏û‡πà‡∏≠</button>
          <button data-member="mom" type="button">‡πÅ‡∏°‡πà</button>
          <button data-member="grandma" type="button">‡∏¢‡∏≤‡∏¢</button>
        </div>

        <div class="chartBox">
          <div class="chartTitle" style="margin-bottom:8px;">
            <b id="trendChartTitle">Overall Health Score ‚Äî ‡∏û‡πà‡∏≠</b>
            <span class="pill" id="trendImprovePill">‡∏î‡∏µ‡∏Ç‡∏∂‡πâ‡∏ô +12%</span>
          </div>
          <canvas id="trendChart"></canvas>
        </div>

        <div class="trendGrid" id="trendCards"></div>

        <div class="encourage">
          <b>‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö üíô</b>
          <p id="trendEncourage">‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô‡∏ó‡∏≥‡πÑ‡∏î‡πâ‡∏î‡∏µ‡∏°‡∏≤‡∏Å! ‡∏™‡∏°‡πà‡∏≥‡πÄ‡∏™‡∏°‡∏≠‡∏≠‡∏µ‡∏Å‡∏ô‡∏¥‡∏î ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏à‡∏∞‡∏¢‡∏¥‡πà‡∏á‡∏ä‡∏±‡∏î‡∏Ç‡∏∂‡πâ‡∏ô‡∏ô‡∏∞‡∏Ñ‡∏∞ üòä</p>
        </div>
      </div>
    </div>

    <!-- PROFILE -->
    <div id="screen-profile" class="hide">
      <div class="card" style="padding:14px;">
        <b>Profile</b>
        <div class="muted" style="margin-top:6px;font-size:12px;">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÉ‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</div>

        <div class="profileGrid" id="profileGrid">
          <button class="personBtn active" data-member="dad" type="button">
            <div class="personTop">
              <div class="personAvatar">üë®</div>
              <div>
                <div class="personName">‡∏û‡πà‡∏≠</div>
                <div class="personRole">Primary user</div>
              </div>
            </div>
            <div class="personHint">‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏î‡∏µ‡∏Ç‡∏∂‡πâ‡∏ô‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á ‚úÖ</div>
          </button>

          <button class="personBtn" data-member="mom" type="button">
            <div class="personTop">
              <div class="personAvatar">üë©</div>
              <div>
                <div class="personName">‡πÅ‡∏°‡πà</div>
                <div class="personRole">Family member</div>
              </div>
            </div>
            <div class="personHint">‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡πÑ‡∏î‡πâ‡∏î‡∏µ‡∏Ç‡∏∂‡πâ‡∏ô ‚úÖ</div>
          </button>

          <button class="personBtn" data-member="grandma" type="button">
            <div class="personTop">
              <div class="personAvatar">üëµ</div>
              <div>
                <div class="personName">‡∏¢‡∏≤‡∏¢</div>
                <div class="personRole">Family member</div>
              </div>
            </div>
            <div class="personHint">‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏£‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏¢ ‡πÜ ‚úÖ</div>
          </button>

          <button class="personBtn" type="button" aria-disabled="true">
            <div class="personTop">
              <div class="personAvatar">Ôºã</div>
              <div>
                <div class="personName">Add Member</div>
                <div class="personRole"></div>
              </div>
            </div>
            <div class="personHint">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</div>
          </button>
        </div>
      </div>
    </div>

    <!-- SIGN IN -->
    <div id="screen-signin" class="hide">
      <div class="card" style="padding:14px;">
        <div class="authHero">
          <b>Sign in</b>
          <p>‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏´‡∏•‡∏≤‡∏¢‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á</p>
        </div>

        <div class="authBox" style="margin-top:12px;">
          <div class="authTabs" id="authTabs">
            <button class="active" type="button" data-pane="email">Email Login</button>
            <button type="button" data-pane="register">Register</button>
          </div>

          <div class="authPane" id="authPaneEmail">
            <div class="field">
              <label>Email</label>
              <input class="input" id="emailInput" type="text" placeholder="‡πÄ‡∏ä‡πà‡∏ô test" autocomplete="email" />
            </div>
            <div class="field">
              <label>Password</label>
              <input class="input" id="passwordInput" type="password" placeholder="‡πÄ‡∏ä‡πà‡∏ô test" autocomplete="current-password" />
            </div>
            <button class="authPrimary" id="emailLoginBtn" type="button">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏î‡πâ‡∏ß‡∏¢‡∏≠‡∏µ‡πÄ‡∏°‡∏•</button>
            <div class="authNote">* ‡πÄ‡∏î‡πÇ‡∏°‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô: ‡πÉ‡∏™‡πà Email = <b>test</b> ‡πÅ‡∏•‡∏∞ Password = <b>test</b> ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏°‡∏ô‡∏π‡∏´‡∏•‡∏±‡∏á‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô</div>
          </div>

          <div class="authPane hide" id="authPaneRegister">
            <div class="field">
              <label>‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡πà‡πÅ‡∏™‡∏î‡∏á</label>
              <input class="input" type="text" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏Ñ‡∏∏‡∏ì‡∏û‡πà‡∏≠" autocomplete="name" />
            </div>
            <div class="field">
              <label>Email</label>
              <input class="input" type="email" placeholder="name@example.com" autocomplete="email" />
            </div>
            <div class="field">
              <label>Password</label>
              <input class="input" type="password" placeholder="‡∏ï‡∏±‡πâ‡∏á‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô" autocomplete="new-password" />
            </div>
            <button class="authPrimary" id="registerBtn" type="button">‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡πÉ‡∏´‡∏°‡πà</button>
            <div class="authNote">* ‡πÄ‡∏î‡πÇ‡∏° UI: ‡∏õ‡∏∏‡πà‡∏°‡∏à‡∏∞‡πÇ‡∏ä‡∏ß‡πå‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÅ‡∏ó‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏à‡∏£‡∏¥‡∏á</div>
          </div>
        </div>

        <div class="divider">‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏î‡πâ‡∏ß‡∏¢</div>

        <div class="oauthList">
          <button class="oauthBtn" id="lineLoginBtn" type="button">
            <span class="oauthIco">üí¨</span>
            <span style="flex:1; min-width:0;">
              <span class="oauthMain">LINE Login</span>
              <span class="oauthSub">‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏î‡πâ‡∏ß‡∏¢ LINE</span>
            </span>
            <span class="settingsArrow">‚Ä∫</span>
          </button>

          <button class="oauthBtn" id="facebookLoginBtn" type="button">
            <span class="oauthIco">üìò</span>
            <span style="flex:1; min-width:0;">
              <span class="oauthMain">Facebook Login</span>
              <span class="oauthSub">‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏î‡πâ‡∏ß‡∏¢ Facebook</span>
            </span>
            <span class="settingsArrow">‚Ä∫</span>
          </button>

          <button class="oauthBtn" id="googleLoginBtn" type="button">
            <span class="oauthIco">üü¶</span>
            <span style="flex:1; min-width:0;">
              <span class="oauthMain">Google Login</span>
              <span class="oauthSub">‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏î‡πâ‡∏ß‡∏¢ Google</span>
            </span>
            <span class="settingsArrow">‚Ä∫</span>
          </button>
        </div>
      </div>
    </div>

    <!-- ACCOUNT (after login) -->
    <div id="screen-account" class="hide">
      <div class="card" style="padding:14px;">
        <div class="accountHeader">
          <div>
            <b>Account</b>
            <div class="muted">‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö <b id="accountUserName">test</b></div>
          </div>
          <span class="pill" id="accountStatusPill">Logged in</span>
        </div>

        <div class="walletCard">
          <div class="walletTop">
            <div>
              <div class="muted" style="font-size:12px; font-weight:900;">Wallet Balance</div>
              <div class="amt" id="walletBalance">‡∏ø120</div>
              <div class="unit">THB</div>
            </div>
            <div class="menuIco" aria-hidden="true">üëõ</div>
          </div>
          <div class="walletMeta">‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏á‡∏¥‡∏ô/‡∏ã‡∏∑‡πâ‡∏≠‡πÅ‡∏û‡πá‡∏Ñ‡πÄ‡∏Å‡∏à‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡πÄ‡∏°‡∏ô‡∏π‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á</div>
          <button class="primaryBtn" id="goTopupBtn" type="button" style="margin-top:12px;">‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤ Top-up</button>
        </div>

        <div class="menuGrid" aria-label="Account menus">
          <button class="menuBtn" id="menuTopup" type="button">
            <div class="menuIco">üí≥</div>
            <div>
              <div class="menuMain">Top-up</div>
              <div class="menuSub">‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏Å‡∏£‡∏∞‡πÄ‡∏õ‡πã‡∏≤</div>
            </div>
          </button>

          <button class="menuBtn" id="menuPackage" type="button">
            <div class="menuIco">üì¶</div>
            <div>
              <div class="menuMain">Package</div>
              <div class="menuSub">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ã‡∏∑‡πâ‡∏≠‡πÅ‡∏û‡πá‡∏Ñ‡πÄ‡∏Å‡∏à</div>
            </div>
          </button>

          <button class="menuBtn" id="menuManage" type="button">
            <div class="menuIco">üß∞</div>
            <div>
              <div class="menuMain">Manage</div>
              <div class="menuSub">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå/‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå</div>
            </div>
          </button>

          <button class="menuBtn" id="menuBilling" type="button">
            <div class="menuIco">üßæ</div>
            <div>
              <div class="menuMain">Billing</div>
              <div class="menuSub">‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à & ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏ä‡∏≥‡∏£‡∏∞</div>
            </div>
          </button>

          <button class="menuBtn" id="menuSupport" type="button">
            <div class="menuIco">üÜò</div>
            <div>
              <div class="menuMain">Support</div>
              <div class="menuSub">‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠</div>
            </div>
          </button>

          <button class="menuBtn" id="menuSecurity" type="button">
            <div class="menuIco">üîí</div>
            <div>
              <div class="menuMain">Security</div>
              <div class="menuSub">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏ö‡∏±‡∏ç‡∏ä‡∏µ</div>
            </div>
          </button>

          <button class="menuBtn" id="logoutBtn" type="button">
            <div class="menuIco">üö™</div>
            <div>
              <div class="menuMain">Logout</div>
              <div class="menuSub">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</div>
            </div>
          </button>
        </div>
      </div>
    </div>

    <!-- PACKAGE (purchase) -->
    <div id="screen-package" class="hide">
      <div class="card" style="padding:14px;">
        <div class="accountHeader">
          <div>
            <b>Package</b>
            <div class="muted">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏û‡πá‡∏Ñ‡πÄ‡∏Å‡∏à‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</div>
          </div>
          <span class="pill" id="currentPlanPill">Plan: None</span>
        </div>

        <div class="walletCard" style="margin-top:12px;">
          <div class="walletTop">
            <div>
              <div class="muted" style="font-size:12px; font-weight:900;">Wallet Balance</div>
              <div class="amt" id="packageWalletBalance">‡∏ø120</div>
              <div class="unit">THB</div>
            </div>
            <div class="menuIco" aria-hidden="true">üëõ</div>
          </div>
          <div class="walletMeta">* ‡πÄ‡∏î‡πÇ‡∏°: ‡∏ã‡∏∑‡πâ‡∏≠‡πÅ‡∏û‡πá‡∏Ñ‡πÄ‡∏Å‡∏à‡∏à‡∏∞‡∏´‡∏±‡∏Å‡πÄ‡∏á‡∏¥‡∏ô‡∏à‡∏≤‡∏Å Wallet</div>
          <button class="primaryBtn" id="packageGoTopupBtn" type="button" style="margin-top:12px;">‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏á‡∏¥‡∏ô (Top-up)</button>
        </div>

        <div class="packageWrap" style="margin-top:12px;">
          <div class="packageGrid" id="packageGrid" aria-label="Package list">
            <button class="packageBtn" type="button" data-plan="Eco" data-price="199" data-users="1">
              <div class="menuIco" aria-hidden="true">üåø</div>
              <div style="flex:1; min-width:0;">
                <div class="packageName">Eco Set</div>
                <div class="packageSub">‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö 1 ‡∏Ñ‡∏ô</div>
                <div class="packageMeta">
                  <span class="packageChip">‡∏£‡∏≤‡∏Ñ‡∏≤ <b>‡∏ø199</b></span>
                  <span class="packageChip">‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ <b>1</b></span>
                </div>
              </div>
              <span class="settingsArrow">‚Ä∫</span>
            </button>

            <button class="packageBtn" type="button" data-plan="Duo" data-price="299" data-users="2">
              <div class="menuIco" aria-hidden="true">ü§ù</div>
              <div style="flex:1; min-width:0;">
                <div class="packageName">Duo Set</div>
                <div class="packageSub">‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö 2 ‡∏Ñ‡∏ô</div>
                <div class="packageMeta">
                  <span class="packageChip">‡∏£‡∏≤‡∏Ñ‡∏≤ <b>‡∏ø299</b></span>
                  <span class="packageChip">‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ <b>2</b></span>
                </div>
              </div>
              <span class="settingsArrow">‚Ä∫</span>
            </button>

            <button class="packageBtn" type="button" data-plan="Family" data-price="399" data-users="4">
              <div class="menuIco" aria-hidden="true">üë®‚Äçüë©‚Äçüëß‚Äçüë¶</div>
              <div style="flex:1; min-width:0;">
                <div class="packageName">Family Set</div>
                <div class="packageSub">‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö 4 ‡∏Ñ‡∏ô</div>
                <div class="packageMeta">
                  <span class="packageChip">‡∏£‡∏≤‡∏Ñ‡∏≤ <b>‡∏ø399</b></span>
                  <span class="packageChip">‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ <b>4</b></span>
                </div>
              </div>
              <span class="settingsArrow">‚Ä∫</span>
            </button>
          </div>

          <div class="authNote">* ‡∏£‡∏≤‡∏Ñ‡∏≤‡πÅ‡∏•‡∏∞‡πÅ‡∏û‡πá‡∏Ñ‡πÄ‡∏Å‡∏à‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô</div>
        </div>
      </div>
    </div>

    <!-- TOP-UP -->
    <div id="screen-topup" class="hide">
      <div class="card" style="padding:14px;">
        <div class="accountHeader">
          <div>
            <b>Top-up</b>
            <div class="muted">‡∏¢‡∏≠‡∏î‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠: <b id="topupBalance">‡∏ø120</b></div>
          </div>
          <span class="pill" id="topupSelectedPill">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</span>
        </div>

        <div class="muted" style="margin-top:10px; font-size:12px; line-height:1.45;">
          ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡∏¥‡∏° ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏¥‡∏ò‡∏µ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô
        </div>

        <div class="amountGrid" id="amountGrid">
          <button class="amountBtn" type="button" data-amount="50">‡∏ø50</button>
          <button class="amountBtn" type="button" data-amount="100">‡∏ø100</button>
          <button class="amountBtn" type="button" data-amount="200">‡∏ø200</button>
          <button class="amountBtn" type="button" data-amount="300">‡∏ø300</button>
          <button class="amountBtn" type="button" data-amount="500">‡∏ø500</button>
          <button class="amountBtn" type="button" data-amount="1000">‡∏ø1,000</button>
        </div>

        <div class="methodList" id="methodList">
          <button class="methodBtn active" type="button" data-method="PromptPay">
            <span class="oauthIco">üì±</span>
            <span style="flex:1; min-width:0;">
              <span class="oauthMain">PromptPay</span>
              <span class="oauthSub">‡∏™‡πÅ‡∏Å‡∏ô QR ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ä‡∏≥‡∏£‡∏∞</span>
            </span>
            <span class="settingsArrow">‚Ä∫</span>
          </button>

          <button class="methodBtn" type="button" data-method="Card">
            <span class="oauthIco">üí≥</span>
            <span style="flex:1; min-width:0;">
              <span class="oauthMain">Credit / Debit Card</span>
              <span class="oauthSub">Visa / Master</span>
            </span>
            <span class="settingsArrow">‚Ä∫</span>
          </button>

          <button class="methodBtn" type="button" data-method="Bank">
            <span class="oauthIco">üè¶</span>
            <span style="flex:1; min-width:0;">
              <span class="oauthMain">Bank Transfer</span>
              <span class="oauthSub">‡πÇ‡∏≠‡∏ô‡∏ú‡πà‡∏≤‡∏ô‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£</span>
            </span>
            <span class="settingsArrow">‚Ä∫</span>
          </button>
        </div>

        <button class="primaryBtn" id="confirmTopupBtn" type="button" style="margin-top:12px;">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô Top-up</button>
        <div class="authNote">* ‡πÄ‡∏î‡πÇ‡∏° UI: ‡∏à‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡πÉ‡∏ô Wallet ‡πÅ‡∏•‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡πÉ‡∏´‡πâ‡∏î‡∏π</div>

        <div class="txnList" id="txnList">
          <div class="txnItem">
            <div class="txnTop"><b>Top-up</b><span>‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á</span></div>
            <div class="txnSub">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà</div>
          </div>
        </div>
      </div>
    </div>

    <!-- DEVICE (placeholder) -->
    <div id="screen-device" class="hide">
      <div class="card" style="padding:14px;">
        <b>Device</b>
        <div class="muted" style="margin-top:6px;font-size:12px;">‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ (‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á)</div>
        <div class="authNote">* ‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô placeholder (‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏à‡∏±‡∏î UI ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡πÉ‡∏ô‡∏£‡∏≠‡∏ö‡∏ô‡∏µ‡πâ)</div>
      </div>
    </div>

    <!-- SETTINGS -->
    <div id="screen-settings" class="hide">
      <div class="card">
        <div style="padding:14px; display:flex; align-items:flex-start; justify-content:space-between; gap:10px;">
          <div>
            <b>Settings</b>
            <div class="muted" style="margin-top:4px; font-size:12px;">‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</div>
          </div>
          <span class="pill">‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</span>
        </div>

        <div class="settingsSection">
          <div class="settingsTitle">Device</div>
          <div class="settingsList">
            <div class="settingsItem">
              <span class="settingsIcon">üîó</span>
              <span class="settingsText">
                <span class="settingsMain">Connected Devices</span>
                <span class="settingsSub">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠</span>
              </span>
              <span class="settingsArrow">‚Ä∫</span>
            </div>
            <div class="settingsItem">
              <span class="settingsIcon">‚ü≥</span>
              <span class="settingsText">
                <span class="settingsMain">Sync Settings</span>
                <span class="settingsSub">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏µ‡πà‡∏Å‡∏≤‡∏£‡∏ã‡∏¥‡∏á‡∏Ñ‡πå / Wi-Fi only</span>
              </span>
              <span class="settingsArrow">‚Ä∫</span>
            </div>
            <div class="settingsItem">
              <span class="settingsIcon">‚¨ÜÔ∏è</span>
              <span class="settingsText">
                <span class="settingsMain">Firmware Update</span>
                <span class="settingsSub">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå</span>
              </span>
              <span class="settingsArrow">‚Ä∫</span>
            </div>
          </div>
        </div>

        <div class="settingsSection">
          <div class="settingsTitle">Family & Profiles</div>
          <div class="settingsList">
            <div class="settingsItem">
              <span class="settingsIcon">üë®‚Äçüë©‚Äçüëß</span>
              <span class="settingsText">
                <span class="settingsMain">Family Members</span>
                <span class="settingsSub">‡∏û‡πà‡∏≠ / ‡πÅ‡∏°‡πà / ‡∏¢‡∏≤‡∏¢</span>
              </span>
              <span class="settingsArrow">‚Ä∫</span>
            </div>
            <div class="settingsItem">
              <span class="settingsIcon">üéØ</span>
              <span class="settingsText">
                <span class="settingsMain">Goals</span>
                <span class="settingsSub">‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô/‡∏£‡∏≤‡∏¢‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå</span>
              </span>
              <span class="settingsArrow">‚Ä∫</span>
            </div>
            <div class="settingsItem">
              <span class="settingsIcon">‚è∞</span>
              <span class="settingsText">
                <span class="settingsMain">Reminders</span>
                <span class="settingsSub">‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ß‡∏±‡∏î‡∏Ñ‡πà‡∏≤/‡∏ó‡∏≤‡∏ô‡∏¢‡∏≤</span>
              </span>
              <span class="settingsArrow">‚Ä∫</span>
            </div>
          </div>
        </div>

        <div class="settingsSection" style="padding-bottom:14px;">
          <div class="settingsTitle">Preferences & Support</div>
          <div class="settingsList">
            <div class="settingsItem">
              <span class="settingsIcon">üìè</span>
              <span class="settingsText">
                <span class="settingsMain">Units</span>
                <span class="settingsSub">mmHg / mg/dL / ¬∞C</span>
              </span>
              <span class="settingsArrow">‚Ä∫</span>
            </div>
            <div class="settingsItem">
              <span class="settingsIcon">üåê</span>
              <span class="settingsText">
                <span class="settingsMain">Language</span>
                <span class="settingsSub">TH / EN</span>
              </span>
              <span class="settingsArrow">‚Ä∫</span>
            </div>
            <div class="settingsItem">
              <span class="settingsIcon">üîí</span>
              <span class="settingsText">
                <span class="settingsMain">Privacy</span>
                <span class="settingsSub">‡∏Å‡∏≤‡∏£‡∏¢‡∏¥‡∏ô‡∏¢‡∏≠‡∏° / ‡∏Å‡∏≤‡∏£‡πÅ‡∏ä‡∏£‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</span>
              </span>
              <span class="settingsArrow">‚Ä∫</span>
            </div>
            <div class="settingsItem">
              <span class="settingsIcon">üÜò</span>
              <span class="settingsText">
                <span class="settingsMain">Help Center</span>
                <span class="settingsSub">‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô & FAQ</span>
              </span>
              <span class="settingsArrow">‚Ä∫</span>
            </div>
            <div class="settingsItem">
              <span class="settingsIcon">‚ÑπÔ∏è</span>
              <span class="settingsText">
                <span class="settingsMain">About</span>
                <span class="settingsSub">‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏≠‡∏õ / ‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</span>
              </span>
              <span class="settingsArrow">‚Ä∫</span>
            </div>
          </div>
        </div>
      </div>
    </div>

  </div>

  <!-- Pretty Alert/Confirm Modal -->
  <div class="modal hide" id="uiModal" aria-hidden="true">
    <div class="modalOverlay" id="uiModalOverlay" aria-hidden="true"></div>
    <div class="modalCard" id="uiModalCard" data-type="info" role="dialog" aria-modal="true" aria-labelledby="uiModalTitle">
      <div class="modalHead">
        <div class="modalTitle">
          <div class="modalIcon" id="uiModalIcon" aria-hidden="true">‚ÑπÔ∏è</div>
          <div class="modalText">
            <b id="uiModalTitle">‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</b>
            <span id="uiModalMsg">...</span>
          </div>
        </div>
        <button class="modalClose" id="uiModalClose" type="button" aria-label="Close">‚úï</button>
      </div>
      <div class="modalBody">
        <div class="modalActions">
          <button class="modalBtn secondary" id="uiModalCancel" type="button">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
          <button class="modalBtn" id="uiModalOk" type="button">‡∏ï‡∏Å‡∏•‡∏á</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Bottom nav -->
  <div class="navwrap">
    <div class="nav" id="nav">
      <button class="active" data-screen="home" type="button">
        <svg class="ico" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M3 10.5 12 3l9 7.5V21a1 1 0 0 1-1 1h-5v-7H9v7H4a1 1 0 0 1-1-1V10.5z" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        Home
      </button>
      <button data-screen="alerts" type="button">
        <svg class="ico" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M18 8a6 6 0 10-12 0c0 7-3 7-3 7h18s-3 0-3-7" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M13.73 21a2 2 0 01-3.46 0" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        Alerts
      </button>
      <button data-screen="trends" type="button">
        <svg class="ico" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M4 19V5" stroke-linecap="round"/>
          <path d="M8 19V11" stroke-linecap="round"/>
          <path d="M12 19V7" stroke-linecap="round"/>
          <path d="M16 19V13" stroke-linecap="round"/>
          <path d="M20 19V9" stroke-linecap="round"/>
        </svg>
        Trends
      </button>
      <button data-screen="profile" type="button">
        <svg class="ico" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M20 21a8 8 0 10-16 0" stroke-linecap="round"/>
          <path d="M12 11a4 4 0 100-8 4 4 0 000 8z" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        Profile
      </button>
      <button data-screen="device" type="button">
        <svg class="ico" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M7 7h10v10H7z" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        Device
      </button>
      <button data-screen="settings" type="button">
        <svg class="ico" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M12 15.5a3.5 3.5 0 110-7 3.5 3.5 0 010 7z" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M19.4 15a7.9 7.9 0 00.1-2l2-1.2-2-3.4-2.3.7a8.4 8.4 0 00-1.7-1l-.3-2.4H10.8l-.3 2.4a8.4 8.4 0 00-1.7 1l-2.3-.7-2 3.4 2 1.2a7.9 7.9 0 00.1 2l-2 1.2 2 3.4 2.3-.7c.5.4 1.1.7 1.7 1l.3 2.4h4.4l.3-2.4c.6-.3 1.2-.6 1.7-1l2.3.7 2-3.4-2-1.2z" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        Settings
      </button>
    </div>
  </div>

  <!-- Chart.js (CDN) -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>

  <script>
    // NOTE:
    // Some preview hosts wrap your entire HTML inside a JS string and call document.write().
    // If we use JavaScript template literals (backticks) inside this file, it can break that wrapper.
    // Therefore: this file intentionally avoids backticks/template-literals.

    function byId(id){ return document.getElementById(id); }

    // --- Pretty Alert/Confirm
    var uiModal = byId('uiModal');
    var uiModalOverlay = byId('uiModalOverlay');
    var uiModalCard = byId('uiModalCard');
    var uiModalIcon = byId('uiModalIcon');
    var uiModalTitle = byId('uiModalTitle');
    var uiModalMsg = byId('uiModalMsg');
    var uiModalClose = byId('uiModalClose');
    var uiModalOk = byId('uiModalOk');
    var uiModalCancel = byId('uiModalCancel');

    var uiModalMode = 'alert'; // alert | confirm
    var uiModalOnClose = null;
    var uiModalOnConfirm = null;
    var uiModalOnCancel = null;

    function uiSetButtons(opts){
      opts = opts || {};
      var okText = opts.okText || (uiModalMode === 'confirm' ? '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô' : '‡∏ï‡∏Å‡∏•‡∏á');
      var cancelText = opts.cancelText || '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å';

      if(uiModalOk) uiModalOk.textContent = okText;
      if(uiModalCancel){
        uiModalCancel.textContent = cancelText;
        uiModalCancel.classList.toggle('hide', uiModalMode !== 'confirm');
      }
    }

    function uiOpenModal(message, opts){
      opts = opts || {};
      var type = opts.type || 'info';
      var title = opts.title || (type === 'success' ? '‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à' : type === 'error' ? '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î' : type === 'warning' ? '‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô' : '‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•');

      // Fallback
      if(!uiModal || !uiModalCard || !uiModalIcon || !uiModalTitle || !uiModalMsg) {
        window.alert((title ? title + ': ' : '') + String(message || ''));
        // If confirm fallback, assume OK
        if(uiModalMode === 'confirm' && typeof uiModalOnConfirm === 'function'){
          try{ uiModalOnConfirm(); } catch(e){}
        }
        return;
      }

      uiModalCard.setAttribute('data-type', type);
      uiModalTitle.textContent = title;
      uiModalMsg.textContent = String(message || '');

      uiModalIcon.textContent =
        (type === 'success') ? '‚úÖ' :
        (type === 'error') ? '‚õî' :
        (type === 'warning') ? '‚ö†Ô∏è' : '‚ÑπÔ∏è';

      uiSetButtons(opts);

      uiModal.classList.remove('hide');
      uiModal.setAttribute('aria-hidden','false');
      try{ (uiModalOk || uiModalClose).focus(); } catch(e){}
    }

    function uiAlert(message, opts){
      opts = opts || {};
      uiModalMode = 'alert';
      uiModalOnClose = (typeof opts.onClose === 'function') ? opts.onClose : null;
      uiModalOnConfirm = null;
      uiModalOnCancel = null;
      uiOpenModal(message, opts);
    }

    function uiConfirm(message, opts){
      opts = opts || {};
      uiModalMode = 'confirm';
      uiModalOnClose = null;
      uiModalOnConfirm = (typeof opts.onConfirm === 'function') ? opts.onConfirm : null;
      uiModalOnCancel = (typeof opts.onCancel === 'function') ? opts.onCancel : null;
      if(!opts.okText) opts.okText = '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô';
      if(!opts.cancelText) opts.cancelText = '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å';
      if(!opts.type) opts.type = 'warning';
      if(!opts.title) opts.title = '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£';
      uiOpenModal(message, opts);
    }

    function closeUiModal(reason){
      if(!uiModal) return;
      uiModal.classList.add('hide');
      uiModal.setAttribute('aria-hidden','true');

      var mode = uiModalMode;
      var onClose = uiModalOnClose;
      var onConfirm = uiModalOnConfirm;
      var onCancel = uiModalOnCancel;

      uiModalOnClose = null;
      uiModalOnConfirm = null;
      uiModalOnCancel = null;
      uiModalMode = 'alert';

      if(mode === 'confirm'){
        if(reason === 'confirm'){
          if(onConfirm){ try{ onConfirm(); } catch(e){} }
        } else {
          if(onCancel){ try{ onCancel(); } catch(e){} }
        }
        return;
      }

      if(onClose){ try{ onClose(); } catch(e){} }
    }

    function modalOkHandler(){
      closeUiModal(uiModalMode === 'confirm' ? 'confirm' : 'close');
    }
    function modalCancelHandler(){
      closeUiModal('cancel');
    }

    if(uiModalOverlay) uiModalOverlay.addEventListener('click', function(){ modalCancelHandler(); });
    if(uiModalClose) uiModalClose.addEventListener('click', function(){ modalCancelHandler(); });
    if(uiModalOk) uiModalOk.addEventListener('click', function(){ modalOkHandler(); });
    if(uiModalCancel) uiModalCancel.addEventListener('click', function(){ modalCancelHandler(); });
    window.addEventListener('keydown', function(e){
      if(!uiModal || uiModal.classList.contains('hide')) return;
      if(e.key === 'Escape') modalCancelHandler();
    });

    // --- Screens nav
    var headerTitle = byId('headerTitle');
    var headerSub = byId('headerSub');
    var nav = byId('nav');

    var screens = {
      home: byId('screen-home'),
      alerts: byId('screen-alerts'),
      trends: byId('screen-trends'),
      profile: byId('screen-profile'),
      device: byId('screen-device'),
      signin: byId('screen-signin'),
      account: byId('screen-account'),
      package: byId('screen-package'),
      topup: byId('screen-topup'),
      settings: byId('screen-settings')
    };

    var currentScreen = 'home';
    var navStack = [];

    // --- Auth state (demo)
    var isLoggedIn = false;
    var loggedInName = 'test';
    var walletBalanceValue = 120;
    var topupSelectedAmount = 0;
    var topupSelectedMethod = 'PromptPay';
    var txns = [];
    var purchasedPlan = '';

    function showScreen(key, noHistory){
      if(!screens[key]) key = 'home';
      if(!noHistory && key !== currentScreen){
        navStack.push(currentScreen);
      }
      currentScreen = key;

      Object.keys(screens).forEach(function(k){
        var el = screens[k];
        if(!el) return;
        el.classList.toggle('hide', k !== key);
      });

      if(headerTitle){
        headerTitle.textContent =
          (key === 'home') ? 'Zyta Dashboard' :
          (key === 'alerts') ? 'Alerts' :
          (key === 'trends') ? 'Trends' :
          (key === 'profile') ? 'Profile' :
          (key === 'device') ? 'Device' :
          (key === 'signin') ? 'Sign in' :
          (key === 'account') ? 'Account' :
          (key === 'package') ? 'Package' :
          (key === 'topup') ? 'Top-up' : 'Settings';
      }

      if(headerSub){
        headerSub.textContent =
          (key === 'home') ? '‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ ‚Ä¢ 9 Jan' :
          (key === 'alerts') ? '‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î' :
          (key === 'trends') ? '‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á' :
          (key === 'profile') ? '‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô' :
          (key === 'device') ? '‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠' :
          (key === 'signin') ? '‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö' :
          (key === 'account') ? '‡∏ö‡∏±‡∏ç‡∏ä‡∏µ' :
          (key === 'package') ? '‡∏ã‡∏∑‡πâ‡∏≠‡πÅ‡∏û‡πá‡∏Ñ‡πÄ‡∏Å‡∏à' :
          (key === 'topup') ? '‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏á‡∏¥‡∏ô' : '‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤';
      }

      if(nav){
        var btns = nav.querySelectorAll('button[data-screen]');
        for(var i=0;i<btns.length;i++){
          var b = btns[i];
          b.classList.toggle('active', b.dataset.screen === key);
        }
      }

      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    if(nav){
      nav.addEventListener('click', function(e){
        var btn = e.target.closest('button[data-screen]');
        if(!btn) return;
        showScreen(btn.dataset.screen);
      });
    }

    // --- Topbar actions
    var signInBtn = byId('signInBtn');
    var topBackBtn = byId('topBackBtn');

    function updatePackageUI(){
      var grid = byId('packageGrid');
      if(!grid) return;
      var btns = grid.querySelectorAll('button[data-plan]');
      for(var i=0;i<btns.length;i++){
        var b = btns[i];
        b.classList.toggle('active', purchasedPlan && b.dataset.plan === purchasedPlan);
      }
    }

    function updateAuthUI(){
      if(signInBtn){
        if(isLoggedIn) signInBtn.classList.add('logged');
        else signInBtn.classList.remove('logged');

        if(isLoggedIn && purchasedPlan){
          signInBtn.classList.add('hasplan');
          signInBtn.setAttribute('data-plan', purchasedPlan);
        } else {
          signInBtn.classList.remove('hasplan');
          signInBtn.removeAttribute('data-plan');
        }
      }

      var accountUserName = byId('accountUserName');
      var walletBalance = byId('walletBalance');
      var topupBalance = byId('topupBalance');
      var accountStatusPill = byId('accountStatusPill');
      var currentPlanPill = byId('currentPlanPill');
      var packageWalletBalance = byId('packageWalletBalance');

      if(accountUserName) accountUserName.textContent = loggedInName;
      if(walletBalance) walletBalance.textContent = '‡∏ø' + walletBalanceValue;
      if(topupBalance) topupBalance.textContent = '‡∏ø' + walletBalanceValue;
      if(packageWalletBalance) packageWalletBalance.textContent = '‡∏ø' + walletBalanceValue;

      if(accountStatusPill){
        accountStatusPill.textContent = purchasedPlan ? ('Plan: ' + purchasedPlan) : 'Logged in';
      }
      if(currentPlanPill){
        currentPlanPill.textContent = purchasedPlan ? ('Plan: ' + purchasedPlan) : 'Plan: None';
      }

      updatePackageUI();
    }

    if(signInBtn){
      signInBtn.addEventListener('click', function(){
        if(isLoggedIn) showScreen('account');
        else showScreen('signin');
      });
    }

    if(topBackBtn){
      topBackBtn.addEventListener('click', function(){
        if(navStack.length > 0){
          var prev = navStack.pop();
          showScreen(prev, true);
          return;
        }
        showScreen('home', true);
      });
    }

    // --- Auth interactions
    var authTabs = byId('authTabs');
    var authPaneEmail = byId('authPaneEmail');
    var authPaneRegister = byId('authPaneRegister');

    function setAuthPane(pane){
      if(!authTabs) return;
      var isEmail = pane === 'email';
      if(authPaneEmail) authPaneEmail.classList.toggle('hide', !isEmail);
      if(authPaneRegister) authPaneRegister.classList.toggle('hide', isEmail);

      var tabBtns = authTabs.querySelectorAll('button[data-pane]');
      for(var i=0;i<tabBtns.length;i++){
        var b = tabBtns[i];
        b.classList.toggle('active', b.dataset.pane === pane);
      }
    }

    if(authTabs){
      authTabs.addEventListener('click', function(e){
        var btn = e.target.closest('button[data-pane]');
        if(!btn) return;
        setAuthPane(btn.dataset.pane);
      });
    }

    var emailLoginBtn = byId('emailLoginBtn');
    var registerBtn = byId('registerBtn');
    var lineLoginBtn = byId('lineLoginBtn');
    var facebookLoginBtn = byId('facebookLoginBtn');
    var googleLoginBtn = byId('googleLoginBtn');

    function demoAuth(provider){
      uiAlert('Demo: ' + provider + ' (‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏£‡∏¥‡∏á)', { type:'info', title:'Demo' });
    }

    function handleEmailLogin(){
      var emailEl = byId('emailInput');
      var passEl = byId('passwordInput');
      var email = emailEl ? String(emailEl.value || '').trim() : '';
      var pass = passEl ? String(passEl.value || '').trim() : '';

      if(email === 'test' && pass === 'test'){
        isLoggedIn = true;
        loggedInName = 'test';
        if(walletBalanceValue < 0) walletBalanceValue = 0;
        updateAuthUI();
        uiAlert('Login success (demo)', { type:'success' });
        showScreen('account');
        return true;
      }

      uiAlert('Email/Password ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á (‡πÄ‡∏î‡πÇ‡∏°: test / test)', { type:'error' });
      return false;
    }

    if(emailLoginBtn) emailLoginBtn.addEventListener('click', function(){ handleEmailLogin(); });
    if(registerBtn) registerBtn.addEventListener('click', function(){ demoAuth('Register'); });
    if(lineLoginBtn) lineLoginBtn.addEventListener('click', function(){ demoAuth('LINE login'); });
    if(facebookLoginBtn) facebookLoginBtn.addEventListener('click', function(){ demoAuth('Facebook login'); });
    if(googleLoginBtn) googleLoginBtn.addEventListener('click', function(){ demoAuth('Google login'); });

    // --- Purchase package
    function gotoTopup(){
      if(!isLoggedIn){
        showScreen('signin');
        return;
      }
      updateAuthUI();
      setTopupAmount(0);
      renderTxnList();
      showScreen('topup');
    }

    function requestPurchase(plan, price){
      if(!isLoggedIn){
        uiAlert('‡πÇ‡∏õ‡∏£‡∏î‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡πà‡∏≠‡∏ô', { type:'warning' });
        showScreen('signin');
        return;
      }

      var p = Number(price) || 0;
      if(p <= 0){
        uiAlert('‡∏£‡∏≤‡∏Ñ‡∏≤‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á', { type:'error' });
        return;
      }

      if(walletBalanceValue < p){
        uiAlert('‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡πÑ‡∏°‡πà‡∏û‡∏≠ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏á‡∏¥‡∏ô‡∏Å‡πà‡∏≠‡∏ô (Wallet: ‡∏ø' + walletBalanceValue + ')', { type:'warning' });
        gotoTopup();
        return;
      }

      var msg =
        '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏ã‡∏∑‡πâ‡∏≠‡πÅ‡∏û‡πá‡∏Ñ‡πÄ‡∏Å‡∏à ' + plan + ' ‡∏£‡∏≤‡∏Ñ‡∏≤ ‡∏ø' + p + '\n' +
        'Wallet ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô: ‡∏ø' + walletBalanceValue + ' ‚Üí ‡∏´‡∏•‡∏±‡∏á‡∏ã‡∏∑‡πâ‡∏≠: ‡∏ø' + (walletBalanceValue - p);

      uiConfirm(msg, {
        type: 'warning',
        title: '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏ã‡∏∑‡πâ‡∏≠‡πÅ‡∏û‡πá‡∏Ñ‡πÄ‡∏Å‡∏à',
        okText: '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ã‡∏∑‡πâ‡∏≠',
        cancelText: '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å',
        onConfirm: function(){ handlePurchase(plan, price); }
      });
    }

    function handlePurchase(plan, price){
      if(!isLoggedIn){
        uiAlert('‡πÇ‡∏õ‡∏£‡∏î‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡πà‡∏≠‡∏ô', { type:'warning' });
        showScreen('signin');
        return;
      }

      var p = Number(price) || 0;
      if(p <= 0){
        uiAlert('‡∏£‡∏≤‡∏Ñ‡∏≤‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á', { type:'error' });
        return;
      }

      if(walletBalanceValue < p){
        uiAlert('‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡πÑ‡∏°‡πà‡∏û‡∏≠ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏á‡∏¥‡∏ô‡∏Å‡πà‡∏≠‡∏ô (Wallet: ‡∏ø' + walletBalanceValue + ')', { type:'warning' });
        gotoTopup();
        return;
      }

      walletBalanceValue = walletBalanceValue - p;
      purchasedPlan = plan;
      updateAuthUI();

      var now = new Date();
      var hh = String(now.getHours()).padStart(2,'0');
      var mm = String(now.getMinutes()).padStart(2,'0');
      txns.unshift({
        title: 'Purchase ' + plan,
        time: hh + ':' + mm,
        desc: 'Paid: ‡∏ø' + p + ' ‚Ä¢ Balance: ‡∏ø' + walletBalanceValue
      });

      renderTxnList();
      uiAlert('‡∏ã‡∏∑‡πâ‡∏≠‡πÅ‡∏û‡πá‡∏Ñ‡πÄ‡∏Å‡∏à‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à (demo): ' + plan, { type:'success' });
    }

    function bindPackageGrid(){
      var grid = byId('packageGrid');
      if(!grid) return;
      grid.addEventListener('click', function(e){
        var btn = e.target.closest('button[data-plan]');
        if(!btn) return;
        var plan = String(btn.dataset.plan || '');
        var price = String(btn.dataset.price || '');
        requestPurchase(plan, price);
      });
    }

    bindPackageGrid();

    // --- Account & Top-up actions
    var goTopupBtn = byId('goTopupBtn');
    var menuTopup = byId('menuTopup');
    var menuPackage = byId('menuPackage');
    var packageGoTopupBtn = byId('packageGoTopupBtn');
    var confirmTopupBtn = byId('confirmTopupBtn');
    var amountGrid = byId('amountGrid');
    var methodList = byId('methodList');
    var topupSelectedPill = byId('topupSelectedPill');
    var txnList = byId('txnList');
    var logoutBtn = byId('logoutBtn');

    function setTopupAmount(v){
      topupSelectedAmount = Number(v) || 0;
      if(topupSelectedPill){
        topupSelectedPill.textContent = topupSelectedAmount > 0 ? ('‡πÄ‡∏•‡∏∑‡∏≠‡∏Å: ‡∏ø' + topupSelectedAmount) : '‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô';
      }
    }

    function setTopupMethod(m){
      topupSelectedMethod = m || 'PromptPay';
    }

    function renderTxnList(){
      if(!txnList) return;
      if(txns.length === 0){
        txnList.innerHTML = '<div class="txnItem"><div class="txnTop"><b>Top-up</b><span>‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á</span></div><div class="txnSub">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà</div></div>';
        return;
      }

      var html = '';
      for(var i=0;i<txns.length;i++){
        var t = txns[i];
        html += '<div class="txnItem">';
        html += '  <div class="txnTop"><b>' + t.title + '</b><span>' + t.time + '</span></div>';
        html += '  <div class="txnSub">' + t.desc + '</div>';
        html += '</div>';
      }
      txnList.innerHTML = html;
    }

    if(goTopupBtn) goTopupBtn.addEventListener('click', function(){ gotoTopup(); });
    if(menuTopup) menuTopup.addEventListener('click', function(){ gotoTopup(); });
    if(packageGoTopupBtn) packageGoTopupBtn.addEventListener('click', function(){ gotoTopup(); });

    if(menuPackage){
      menuPackage.addEventListener('click', function(){
        if(!isLoggedIn){ showScreen('signin'); return; }
        updateAuthUI();
        showScreen('package');
      });
    }

    if(amountGrid){
      amountGrid.addEventListener('click', function(e){
        var btn = e.target.closest('button[data-amount]');
        if(!btn) return;
        var amount = Number(btn.dataset.amount) || 0;
        var all = amountGrid.querySelectorAll('button[data-amount]');
        for(var i=0;i<all.length;i++){
          all[i].classList.toggle('active', all[i] === btn);
        }
        setTopupAmount(amount);
      });
    }

    if(methodList){
      methodList.addEventListener('click', function(e){
        var btn = e.target.closest('button[data-method]');
        if(!btn) return;
        var method = String(btn.dataset.method || 'PromptPay');
        var all = methodList.querySelectorAll('button[data-method]');
        for(var i=0;i<all.length;i++){
          all[i].classList.toggle('active', all[i] === btn);
        }
        setTopupMethod(method);
      });
    }

    if(confirmTopupBtn){
      confirmTopupBtn.addEventListener('click', function(){
        if(!isLoggedIn){
          uiAlert('‡πÇ‡∏õ‡∏£‡∏î‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡πà‡∏≠‡∏ô', { type:'warning' });
          showScreen('signin');
          return;
        }
        if(topupSelectedAmount <= 0){
          uiAlert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÄ‡∏ï‡∏¥‡∏°', { type:'warning' });
          return;
        }

        var msg =
          '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏á‡∏¥‡∏ô ‡∏ø' + topupSelectedAmount + '\n' +
          '‡∏ß‡∏¥‡∏ò‡∏µ‡∏ä‡∏≥‡∏£‡∏∞: ' + topupSelectedMethod + '\n' +
          'Wallet ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô: ‡∏ø' + walletBalanceValue + ' ‚Üí ‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏ï‡∏¥‡∏°: ‡∏ø' + (walletBalanceValue + topupSelectedAmount);

        uiConfirm(msg, {
          type: 'warning',
          title: '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô Top-up',
          okText: '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÄ‡∏ï‡∏¥‡∏°',
          cancelText: '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å',
          onConfirm: function(){
            walletBalanceValue = walletBalanceValue + topupSelectedAmount;
            updateAuthUI();

            var now = new Date();
            var hh = String(now.getHours()).padStart(2,'0');
            var mm = String(now.getMinutes()).padStart(2,'0');
            txns.unshift({
              title: 'Top-up ‡∏ø' + topupSelectedAmount,
              time: hh + ':' + mm,
              desc: 'Method: ' + topupSelectedMethod + ' ‚Ä¢ Balance: ‡∏ø' + walletBalanceValue
            });

            renderTxnList();
            uiAlert('Top-up success (demo)', { type:'success' });
          }
        });
      });
    }

    if(logoutBtn){
      logoutBtn.addEventListener('click', function(){
        isLoggedIn = false;
        purchasedPlan = '';
        updateAuthUI();
        uiAlert('Logged out (demo)', { type:'info' });
        showScreen('home');
      });
    }

    // Placeholder menus
    var menuManage = byId('menuManage');
    var menuBilling = byId('menuBilling');
    var menuSupport = byId('menuSupport');
    var menuSecurity = byId('menuSecurity');

    if(menuManage) menuManage.addEventListener('click', function(){ uiAlert('Manage (demo)', { type:'info' }); });
    if(menuBilling) menuBilling.addEventListener('click', function(){ uiAlert('Billing (demo)', { type:'info' }); });
    if(menuSupport) menuSupport.addEventListener('click', function(){ uiAlert('Support (demo)', { type:'info' }); });
    if(menuSecurity) menuSecurity.addEventListener('click', function(){ uiAlert('Security (demo)', { type:'info' }); });

    // --- Family data
    var family = {
      dad: { name: '‡∏û‡πà‡∏≠', improvePct: 12, series: [62, 64, 66, 67, 69, 71, 74], summary: { bp: 12, glucose: 9, spo2: 3, advice: '‡πÇ‡∏ü‡∏Å‡∏±‡∏™‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏Å‡∏ú‡πà‡∏≠‡∏ô + ‡πÄ‡∏î‡∏¥‡∏ô‡πÄ‡∏ö‡∏≤ ‡πÜ ‡∏´‡∏•‡∏±‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£ 10‚Äì15 ‡∏ô‡∏≤‡∏ó‡∏µ' }, encourage: '‡∏™‡∏∏‡∏î‡∏¢‡∏≠‡∏î‡πÄ‡∏•‡∏¢‡∏û‡πà‡∏≠! ‡∏ó‡∏≥‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏≠‡∏µ‡∏Å‡∏ô‡∏¥‡∏î‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô‡∏ú‡∏•‡∏ä‡∏±‡∏î‡∏Ç‡∏∂‡πâ‡∏ô‡∏ô‡∏∞‡∏Ñ‡∏∞ üí™' },
      mom: { name: '‡πÅ‡∏°‡πà', improvePct: 10, series: [60, 62, 63, 65, 67, 70, 73], summary: { bp: 10, glucose: 11, spo2: 2, advice: '‡∏Ñ‡∏∏‡∏°‡∏´‡∏ß‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏î‡∏µ‡∏°‡∏≤‡∏Å ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏î‡∏∑‡πà‡∏°‡∏ô‡πâ‡∏≥ + ‡∏ô‡∏≠‡∏ô‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö 7‚Äì8 ‡∏ä‡∏°.' }, encourage: '‡πÅ‡∏°‡πà‡∏ó‡∏≥‡πÑ‡∏î‡πâ‡∏î‡∏µ‡∏°‡∏≤‡∏Å‡∏Ñ‡πà‡∏∞ üíô ‡∏™‡∏°‡πà‡∏≥‡πÄ‡∏™‡∏°‡∏≠‡πÅ‡∏ö‡∏ö‡∏ô‡∏µ‡πâ‡πÑ‡∏õ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏¢ ‡πÜ ‡∏ô‡∏∞‡∏Ñ‡∏∞' },
      grandma: { name: '‡∏¢‡∏≤‡∏¢', improvePct: 8, series: [58, 59, 61, 62, 64, 66, 69], summary: { bp: 8, glucose: 7, spo2: 4, advice: '‡∏ó‡∏≤‡∏ô‡∏¢‡∏≤‡∏ï‡∏≤‡∏°‡πÄ‡∏ß‡∏•‡∏≤ + ‡∏Ç‡∏¢‡∏±‡∏ö‡∏ï‡∏±‡∏ß‡πÄ‡∏ö‡∏≤ ‡πÜ ‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô‡∏ä‡πà‡∏ß‡∏¢‡πÑ‡∏î‡πâ‡∏°‡∏≤‡∏Å' }, encourage: '‡∏¢‡∏≤‡∏¢‡πÄ‡∏Å‡πà‡∏á‡∏°‡∏≤‡∏Å‡πÄ‡∏•‡∏¢‡∏Ñ‡πà‡∏∞ üå∑ ‡∏Ñ‡πà‡∏≠‡∏¢ ‡πÜ ‡∏î‡∏µ‡∏Ç‡∏∂‡πâ‡∏ô‡πÅ‡∏ö‡∏ö‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∑‡∏≠‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡πÅ‡∏•‡πâ‡∏ß‡∏ô‡∏∞‡∏Ñ‡∏∞' }
    };

    var activeMember = 'dad';
    var activeUserPill = byId('activeUserPill');

    var homeCanvas = byId('homeTrendChart');
    var trendCanvas = byId('trendChart');
    var canChart = typeof window.Chart !== 'undefined';

    var homeTrendChart = null;
    if(canChart && homeCanvas){
      homeTrendChart = new Chart(homeCanvas, {
        type: 'line',
        data: {
          labels: ['08:00','10:00','12:00','14:00','16:00','18:00','20:00'],
          datasets: [{
            label: 'Health Score',
            data: family[activeMember].series,
            borderColor: '#0ea5e9',
            backgroundColor: 'rgba(14,165,233,0.14)',
            borderWidth: 2,
            tension: 0.35,
            pointRadius: 2,
            pointBackgroundColor: '#2563eb',
            fill: true
          }]
        },
        options: {
          responsive:true,
          maintainAspectRatio:false,
          plugins: { legend: { display:false } },
          scales: {
            x: { grid:{ display:false }, ticks:{ color:'#5b6b82', font:{ size:10 } } },
            y: { grid:{ color:'rgba(215,230,248,.9)' }, ticks:{ color:'#86a0c2', font:{ size:10 } } }
          }
        }
      });
    }

    var trendChart = null;
    if(canChart && trendCanvas){
      trendChart = new Chart(trendCanvas, {
        type: 'line',
        data: {
          labels: ['W1','W2','W3','W4','W5','W6','W7'],
          datasets: [{
            label: 'Overall Health Score',
            data: family.dad.series,
            borderColor: '#2563eb',
            backgroundColor: 'rgba(37,99,235,0.12)',
            borderWidth: 2,
            tension: 0.35,
            pointRadius: 2,
            pointBackgroundColor: '#0ea5e9',
            fill: true
          }]
        },
        options: {
          responsive:true,
          maintainAspectRatio:false,
          plugins: { legend: { display:false } },
          scales: {
            x: { grid:{ display:false }, ticks:{ color:'#5b6b82', font:{ size:10 } } },
            y: { grid:{ color:'rgba(215,230,248,.9)' }, ticks:{ color:'#86a0c2', font:{ size:10 } } }
          }
        }
      });
    }

    function setActiveMember(key){
      if(!family[key]) return;
      activeMember = key;
      if(activeUserPill) activeUserPill.textContent = '‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô: ' + family[key].name;
      if(homeTrendChart){
        homeTrendChart.data.datasets[0].data = family[key].series;
        homeTrendChart.update();
      }
    }

    var trendMemberSeg = byId('trendMemberSeg');
    var trendChartTitle = byId('trendChartTitle');
    var trendImprovePill = byId('trendImprovePill');
    var trendCards = byId('trendCards');
    var trendEncourage = byId('trendEncourage');

    function renderTrendCards(memberKey){
      var d = family[memberKey];
      var s = d.summary;

      if(trendChartTitle) trendChartTitle.textContent = 'Overall Health Score ‚Äî ' + d.name;
      if(trendImprovePill) trendImprovePill.textContent = '‡∏î‡∏µ‡∏Ç‡∏∂‡πâ‡∏ô +' + d.improvePct + '%';
      if(trendEncourage) trendEncourage.textContent = d.encourage;

      if(trendCards){
        var html = '';
        html += '<div class="trendCard">';
        html += '  <div class="trendHead">';
        html += '    <b>‡∏Å‡∏£‡∏≠‡∏ö‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°</b>';
        html += '    <span class="pill">Improving</span>';
        html += '  </div>';
        html += '  <div class="trendSmall">‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏° 30 ‡∏ß‡∏±‡∏ô‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏Ç‡∏≠‡∏á <b>' + d.name + '</b> ‡∏î‡∏µ‡∏Ç‡∏∂‡πâ‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£ ‚Äú‡∏ó‡∏≥‡∏ï‡πà‡∏≠‚Äù ‡πÉ‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡πÄ‡∏î‡∏¥‡∏°</div>';
        html += '  <div class="tags">';
        html += '    <span class="tag">BP ‡∏î‡∏µ‡∏Ç‡∏∂‡πâ‡∏ô <b>' + s.bp + '%</b></span>';
        html += '    <span class="tag">Glucose ‡∏î‡∏µ‡∏Ç‡∏∂‡πâ‡∏ô <b>' + s.glucose + '%</b></span>';
        html += '    <span class="tag">SpO‚ÇÇ ‡∏î‡∏µ‡∏Ç‡∏∂‡πâ‡∏ô <b>' + s.spo2 + '%</b></span>';
        html += '  </div>';
        html += '</div>';

        html += '<div class="trendCard">';
        html += '  <div class="trendHead">';
        html += '    <b>‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</b>';
        html += '    <span class="pill">Next step</span>';
        html += '  </div>';
        html += '  <div class="trendSmall">' + s.advice + '</div>';
        html += '  <div class="trendSmall" style="margin-top:8px;">‡πÇ‡∏ü‡∏Å‡∏±‡∏™ 1 ‡∏≠‡∏¢‡πà‡∏≤‡∏á/‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå ‡∏à‡∏∞‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå ‚Äú‡∏ä‡∏±‡∏î‚Äù ‡πÅ‡∏•‡∏∞ ‚Äú‡∏¢‡∏±‡πà‡∏á‡∏¢‡∏∑‡∏ô‚Äù ‡∏°‡∏≤‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô</div>';
        html += '</div>';

        trendCards.innerHTML = html;
      }
    }

    function setTrendMember(memberKey){
      if(!family[memberKey]) return;

      if(trendMemberSeg){
        var buttons = trendMemberSeg.querySelectorAll('button[data-member]');
        for(var i=0;i<buttons.length;i++){
          var b = buttons[i];
          b.classList.toggle('active', b.dataset.member === memberKey);
        }
      }

      if(trendChart){
        trendChart.data.datasets[0].data = family[memberKey].series;
        trendChart.update();
      }

      renderTrendCards(memberKey);
    }

    if(trendMemberSeg){
      trendMemberSeg.addEventListener('click', function(e){
        var btn = e.target.closest('button[data-member]');
        if(!btn) return;
        setTrendMember(btn.dataset.member);
      });
    }

    var profileGrid = byId('profileGrid');
    if(profileGrid){
      profileGrid.addEventListener('click', function(e){
        var btn = e.target.closest('.personBtn[data-member]');
        if(!btn) return;

        var key = btn.dataset.member;
        var all = profileGrid.querySelectorAll('.personBtn[data-member]');
        for(var i=0;i<all.length;i++){
          var b = all[i];
          b.classList.toggle('active', b.dataset.member === key);
        }

        setActiveMember(key);
      });
    }

    // --- Tests
    // Run tests only when URL contains ?debug=1
    (function runTests(){
      var search = String(window.location && window.location.search ? window.location.search : '');
      var shouldRun = search.indexOf('debug=1') !== -1;
      if(!shouldRun) return;

      var prevScreen = currentScreen;
      var prevLogged = isLoggedIn;
      var prevName = loggedInName;
      var prevBalance = walletBalanceValue;
      var prevPlan = purchasedPlan;
      var prevStack = navStack.slice();

      var required = [
        'headerTitle','headerSub','nav',
        'screen-home','screen-alerts','screen-trends','screen-profile','screen-device','screen-signin','screen-account','screen-package','screen-topup','screen-settings',
        'activeUserPill','trendMemberSeg','trendCards',
        'emailInput','passwordInput','emailLoginBtn',
        'walletBalance','topupBalance','goTopupBtn','confirmTopupBtn',
        'menuPackage','packageGrid','currentPlanPill','packageWalletBalance','packageGoTopupBtn',
        'uiModal','uiModalCard','uiModalOk','uiModalCancel'
      ];

      var results = [];
      for(var i=0;i<required.length;i++){
        var id = required[i];
        results.push({ test: 'exists #' + id, pass: !!byId(id) });
      }

      function safeCall(name, fn){
        try{ fn(); results.push({ test:name, pass:true }); }
        catch(e){ results.push({ test:name, pass:false, error: String(e) }); }
      }

      function clickIfExists(id){
        var el = byId(id);
        if(el && typeof el.click === 'function') el.click();
      }

      safeCall('showScreen cycle', function(){
        showScreen('home', true);
        showScreen('alerts', true);
        showScreen('trends', true);
        showScreen('profile', true);
        showScreen('device', true);
        showScreen('signin', true);
        showScreen('settings', true);
        showScreen('account', true);
        showScreen('topup', true);
        showScreen('package', true);
      });

      safeCall('uiAlert open/close', function(){
        uiAlert('Test modal', { type:'info', title:'Test' });
        closeUiModal('close');
      });

      safeCall('uiConfirm confirm/cancel', function(){
        var confirmed = 0;
        var canceled = 0;
        uiConfirm('Confirm test', {
          onConfirm: function(){ confirmed++; },
          onCancel: function(){ canceled++; }
        });
        clickIfExists('uiModalOk');

        uiConfirm('Confirm cancel test', {
          onConfirm: function(){ confirmed++; },
          onCancel: function(){ canceled++; }
        });
        clickIfExists('uiModalCancel');

        if(confirmed < 1) throw new Error('Confirm did not fire');
        if(canceled < 1) throw new Error('Cancel did not fire');
      });

      safeCall('purchase confirm flow', function(){
        isLoggedIn = true;
        walletBalanceValue = 500;
        purchasedPlan = '';
        updateAuthUI();
        requestPurchase('Eco','199');
        clickIfExists('uiModalOk');
        if(purchasedPlan !== 'Eco') throw new Error('Plan not set');
        if(walletBalanceValue !== 301) throw new Error('Balance not deducted correctly');
      });

      safeCall('topup confirm flow', function(){
        isLoggedIn = true;
        walletBalanceValue = 100;
        topupSelectedAmount = 50;
        topupSelectedMethod = 'PromptPay';
        updateAuthUI();
        // simulate clicking confirm
        var msg = '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏á‡∏¥‡∏ô ‡∏ø' + topupSelectedAmount + '\n' +
                  '‡∏ß‡∏¥‡∏ò‡∏µ‡∏ä‡∏≥‡∏£‡∏∞: ' + topupSelectedMethod + '\n' +
                  'Wallet ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô: ‡∏ø' + walletBalanceValue + ' ‚Üí ‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏ï‡∏¥‡∏°: ‡∏ø' + (walletBalanceValue + topupSelectedAmount);
        uiConfirm(msg, {
          title:'‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô Top-up',
          okText:'‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÄ‡∏ï‡∏¥‡∏°',
          cancelText:'‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å',
          onConfirm: function(){ walletBalanceValue = walletBalanceValue + topupSelectedAmount; }
        });
        clickIfExists('uiModalOk');
        if(walletBalanceValue !== 150) throw new Error('Topup not applied');
      });

      // Restore state
      isLoggedIn = prevLogged;
      loggedInName = prevName;
      walletBalanceValue = prevBalance;
      purchasedPlan = prevPlan;
      navStack = prevStack;
      updateAuthUI();
      showScreen(prevScreen || 'home', true);

      console.table(results);
    })();

    function initFromHash(){
      var h = String(window.location && window.location.hash ? window.location.hash : '').replace('#','');
      if(h && screens[h]){
        showScreen(h, true);
        return;
      }
      showScreen('home', true);
    }

    window.addEventListener('hashchange', function(){ initFromHash(); });

    updateAuthUI();
    initFromHash();
    setActiveMember(activeMember);
    setTrendMember('dad');
  </script>
</body>
</html>
